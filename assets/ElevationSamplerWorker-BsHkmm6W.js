import{fc as e,m as t}from"./index-DSIPxOWi.js";import{h as n}from"./PooledRBush-DOZnXWx2.js";import{M as f}from"./vertexSpaceConversion-C_GU75pR.js";import"./quickselect-D9ta8ndX.js";class r{async createIndex(t,l){var m;const u=new Array;if(!(null==(m=t.vertexAttributes)?void 0:m.position))return new n;const p=function a(t){var n;const{vertexAttributes:{position:l},vertexSpace:m,spatialReference:u,transform:p}=t,x=null==(n=f({vertexAttributes:{position:l},vertexSpace:m,spatialReference:u,transform:p},new e,{allowBufferReuse:!0}))?void 0:n.position;return x?!t.components||t.components.some((e=>!e.faces))?{position:x.buffer}:{position:x.buffer,components:t.components.map((e=>e.faces))}:null}(t),x=null!=l?await l.invoke("createIndexThread",p,{transferList:u}):this.createIndexThread(p).result;return i().fromJSON(x)}createIndexThread(e){const t=i();if(!e)return{result:t.toJSON()};const n=new Float64Array(e.position);return e.components?function s(e,t,n){let f=0;for(const u of n)f+=u.length/3;const l=new Array(f);let m=0;for(const u of n)for(let e=0;e<u.length;e+=3)l[m++]=c(t,3*u[e],3*u[e+1],3*u[e+2]);return e.load(l),{result:e.toJSON()}}(t,n,e.components.map((e=>new Uint32Array(e)))):function o(e,t){const n=new Array(t.length/9);let f=0;for(let l=0;l<t.length;l+=9)n[f++]=c(t,l,l+3,l+6);return e.load(n),{result:e.toJSON()}}(t,n)}}function i(){return new n(9,t("esri-csp-restrictions")?e=>e:[".minX",".minY",".maxX",".maxY"])}function c(e,t,n,f){return{minX:Math.min(e[t],e[n],e[f]),maxX:Math.max(e[t],e[n],e[f]),minY:Math.min(e[t+1],e[n+1],e[f+1]),maxY:Math.max(e[t+1],e[n+1],e[f+1]),p0:[e[t],e[t+1],e[t+2]],p1:[e[n],e[n+1],e[n+2]],p2:[e[f],e[f+1],e[f+2]]}}export{r as default};
