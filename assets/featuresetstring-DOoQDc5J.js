import{a as n,H as a,a1 as e,m as t,B as r,a2 as o,b as i,r as s,a3 as c,N as d,A as u,a4 as m,a5 as f,a6 as l,a7 as y,P as v,a8 as w,a9 as p,aa as h}from"./arcadeUtils-CHsZDnQG.js";import"./index-DSIPxOWi.js";import"./TimeOnly-C5lZbbIX.js";import"./ImmutableArray-BLzlMo4D.js";import"./number-DXNV0RYc.js";import"./hash-BjBdcEEU.js";function T(n,a){return n&&n.domain?"coded-value"===n.domain.type||"codedValue"===n.domain.type?d.convertObjectToArcadeDictionary({type:"codedValue",name:n.domain.name,dataType:h[n.field.type],codedValues:n.domain.codedValues.map((n=>({name:n.name,code:n.code})))},u(a)):d.convertObjectToArcadeDictionary({type:"range",name:n.domain.name,dataType:h[n.field.type],min:n.domain.minValue,max:n.domain.maxValue},u(a)):null}function b(h){"async"===h.mode&&(h.functions.domain=function(c,d){return h.standardFunctionAsync(c,d,(async(u,m,f)=>{if(n(f,2,3,c,d),a(f[0]))return T(e(f[0],t(f[1]),void 0===f[2]?void 0:f[2]),c);if(r(f[0]))return await f[0]._ensureLoaded(),T(o(t(f[1]),f[0],null,void 0===f[2]?void 0:f[2]),c);throw new i(c,s.InvalidParameter,d)}))},h.functions.subtypes=function(e,t){return h.standardFunctionAsync(e,t,(async(o,m,f)=>{if(n(f,1,1,e,t),a(f[0])){const n=c(f[0]);return n?d.convertObjectToArcadeDictionary(n,u(e)):null}if(r(f[0])){await f[0]._ensureLoaded();const n=f[0].subtypeMetaData();return n?d.convertObjectToArcadeDictionary(n,u(e)):null}throw new i(e,s.InvalidParameter,t)}))},h.functions.domainname=function(e,c){return h.standardFunctionAsync(e,c,(async(d,u,l)=>{if(n(l,2,4,e,c),a(l[0]))return m(l[0],t(l[1]),l[2],void 0===l[3]?void 0:l[3]);if(r(l[0])){await l[0]._ensureLoaded();const n=o(t(l[1]),l[0],null,void 0===l[3]?void 0:l[3]);return f(n,l[2])}throw new i(e,s.InvalidParameter,c)}))},h.signatures.push({name:"domainname",min:2,max:4}),h.functions.domaincode=function(e,c){return h.standardFunctionAsync(e,c,(async(d,u,m)=>{if(n(m,2,4,e,c),a(m[0]))return l(m[0],t(m[1]),m[2],void 0===m[3]?void 0:m[3]);if(r(m[0])){await m[0]._ensureLoaded();const n=o(t(m[1]),m[0],null,void 0===m[3]?void 0:m[3]);return y(n,m[2])}throw new i(e,s.InvalidParameter,c)}))},h.signatures.push({name:"domaincode",min:2,max:4}),h.functions.text=function(a,e){return h.standardFunctionAsync(a,e,(async(t,o,c)=>{if(n(c,1,2,a,e),r(c[0])){const n=v(c[1],"");if(""===n)return c[0].castToText();if("schema"===n.toLowerCase())return c[0].convertToText("schema",t.abortSignal);if("featureset"===n.toLowerCase())return c[0].convertToText("featureset",t.abortSignal);throw new i(a,s.InvalidParameter,e)}return w(c[0],c[1])}))},h.functions.gdbversion=function(e,t){return h.standardFunctionAsync(e,t,(async(o,c,d)=>{if(n(d,1,1,e,t),a(d[0]))return d[0].gdbVersion();if(r(d[0]))return(await d[0].load()).gdbVersion;throw new i(e,s.InvalidParameter,t)}))},h.functions.schema=function(e,t){return h.standardFunctionAsync(e,t,(async(o,c,m)=>{if(n(m,1,1,e,t),r(m[0]))return await m[0].load(),d.convertObjectToArcadeDictionary(m[0].schema(),u(e));if(a(m[0])){const n=p(m[0]);return n?d.convertObjectToArcadeDictionary(n,u(e)):null}throw new i(e,s.InvalidParameter,t)}))})}export{b as registerFunctions};
