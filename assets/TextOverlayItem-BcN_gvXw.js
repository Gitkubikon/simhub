import{ez as e,ma as o,mb as i,aO as n,e as s,y as a,a as l,S as u,ak as h}from"./index-DSIPxOWi.js";import{g as c,D as x,y as p,d as f,B as b,w as v,Z as m,p as _,x as T,F as z,$,h as B,M as P,j as O}from"./unitFormatUtils-B9MPZ1wj.js";function e$1(i){var n,s;const a="metric";if(null==i)return a;const l=i.map,u=(l&&"portalItem"in l?null==(n=l.portalItem)?void 0:n.portal:null)??e.getDefault();switch((null==(s=u.user)?void 0:s.units)??u.units){case a:return a;case"english":return"imperial"}return o(i.spatialReference)??a}function g(e,o,n,s=2,a="abbr"){return c(e,i(o,n).value,n,s,a)}function L(e,o,n,s=2,a="abbr"){return _(e,i(o,n).value,n,s,a)}function M(e,o,i=2,n="abbr"){return x(e,o.value,o.unit,i,n)}function w(e,o,i=2,n="abbr"){return p(e,o.value,o.unit,i,n)}function y(e,o,i=2,n="abbr"){return f(e,o.value,o.unit,i,n)}function j(e,o,i=2,n="abbr"){return b(e,o.value,o.unit,i,n)}function U(e,o,i,s=n,a=!0){return v(e.value,e.unit,e.rotationType,o,i,s,a)}function q(e,o,i){return m(e.value,e.unit,e.rotationType,o,i)}function x$1(e,o,i,n,s="abbr"){switch(n=n??2,i){case"imperial":return y(e,o,n,s);case"metric":return M(e,o,n,s);default:return g(e,o,i,n,s)}}function C(e,o,i,n=2,s="abbr"){switch(i){case"imperial":return function V(e,o,i=2,n="abbr"){return B(e,o.value,o.unit,i,n)}(e,o,n,s);case"metric":return function d(e,o,i=2,n="abbr"){return T(e,o.value,o.unit,i,n)}(e,o,n,s);default:return L(e,o,i,n,s)}}function F(e,o,i,n=2,s="abbr"){switch(i){case"imperial":return j(e,o,n,s);case"metric":return w(e,o,n,s);default:return g(e,o,i,n,s)}}function S(e,o,i,n=2,s="abbr"){switch(i){case"imperial":return function D(e,o,i=2,n="abbr"){return P(e,o.value,o.unit,i,n)}(e,o,n,s);case"metric":return function I(e,o,i=2,n="abbr"){return z(e,o.value,o.unit,i,n)}(e,o,n,s);default:return L(e,o,i,n,s)}}function k(e,o,i,n=2,s="abbr"){switch(i){case"imperial":return function A(e,o,i=2,n="abbr"){return O(e,o.value,o.unit,i,n)}(e,o,n,s);case"metric":return function R(e,o,i=2,n="abbr"){return $(e,o.value,o.unit,i,n)}(e,o,n,s);default:return g(e,o,i,n,s)}}let r=(e,o,i)=>{for(let n=0,s=o.length;n<s;n++){let s=o[n];Array.isArray(s)?r(e,s,i):null!=s&&!1!==s&&("string"==typeof s&&(s={vnodeSelector:"",properties:void 0,children:void 0,text:s.toString(),domNode:null}),i.push(s))}};function t(e,o,i){if(Array.isArray(o))i=o,o=void 0;else if(o&&("string"==typeof o||o.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let n,s;return i&&1===i.length&&"string"==typeof i[0]?n=i[0]:i&&(s=[],r(e,i,s),0===s.length&&(s=void 0)),{vnodeSelector:e,properties:o,children:s,text:""===n?void 0:n,domNode:null}}const N={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let E=class extends u{get position(){return[this.x,this.y]}set position(e){this._set("x",e[0]),this._set("y",e[1])}get _textShadowColor(){const{textColor:e,backgroundColor:o}=this,i=o.clone();return i.a*=e.a,i}get _textShadow(){const e=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${e}`}get padding(){return.5*this.fontSize}get _borderRadius(){return this.padding}constructor(e){super(e),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.isDecoration=!0,this.backgroundColor=new h([0,0,0,.6]),this.textColor=new h([255,255,255]),this._textShadowSize=1}render(){return t("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this.padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(e){if(!this.visible)return;const o=e.font.replace(/^(.*?)px/,"");e.font=`${this.fontSize}px ${o}`;const i=this.padding,n=this._borderRadius,s=e.measureText(this.text).width,a=this.fontSize,l=H[this.anchor];e.textAlign="center",e.textBaseline="middle";const u=s+2*i,h=a+2*i,c=this.x+l.x*u,x=this.y+l.y*h;this._roundedRect(e,c,x,u,h,n),e.fillStyle=this.backgroundColor.toCss(!0),e.fill();const p=this.x+(l.x+.5)*u,f=this.y+(l.y+.5)*h;this._renderTextShadow(e,this.text,p,f),e.fillStyle=this.textColor.toCss(!0),e.fillText(this.text,p,f)}_renderTextShadow(e,o,i,n){e.lineJoin="miter",e.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/J.length})`;const s=this._textShadowSize;for(const[a,l]of J)e.fillText(o,i+s*a,n+s*l)}_roundedRect(e,o,i,n,s,a){e.beginPath(),e.moveTo(o,i+a),e.arcTo(o,i,o+a,i,a),e.lineTo(o+n-a,i),e.arcTo(o+n,i,o+n,i+a,a),e.lineTo(o+n,i+s-a),e.arcTo(o+n,i+s,o+n-a,i+s,a),e.lineTo(o+a,i+s),e.arcTo(o,i+s,o,i+s-a,a),e.closePath()}_cssClasses(){const e={"esri-text-overlay-item":!0};let o;for(o in N)e[N[o]]=this.anchor===o;return e}};s([a()],E.prototype,"x",void 0),s([a()],E.prototype,"y",void 0),s([a()],E.prototype,"position",null),s([a()],E.prototype,"text",void 0),s([a()],E.prototype,"fontSize",void 0),s([a()],E.prototype,"anchor",void 0),s([a()],E.prototype,"visible",void 0),s([a()],E.prototype,"isDecoration",void 0),s([a()],E.prototype,"backgroundColor",void 0),s([a()],E.prototype,"textColor",void 0),s([a()],E.prototype,"_textShadowSize",void 0),s([a()],E.prototype,"_textShadowColor",null),s([a()],E.prototype,"_textShadow",null),s([a()],E.prototype,"padding",null),s([a()],E.prototype,"_borderRadius",null),E=s([l("esri.views.overlay.TextOverlayItem")],E);const H={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},J=[];{const e=16;for(let o=0;o<360;o+=360/e)J.push([Math.cos(Math.PI*o/180),Math.sin(Math.PI*o/180)])}const G=E;export{C,F,M,S,U,x$1 as a,e$1 as e,g,j,k,q,t,w,G as x,y};
