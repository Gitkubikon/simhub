import{h7 as e,h8 as t,h9 as r,ha as n,hb as i,hc as o,hd as l,Q as c,ee as h,g$ as f,t as d}from"./index-DSIPxOWi.js";function a(e,c,h,f){if(null==c||null==f)return!1;const d=t(c,f,_);if(d.projector===r)return h[0]=e[0],h[1]=e[1],h[2]=e[2],h[3]=e[3],!0;if(null==d.projector)return!1;const{source:p,dest:E}=d;if(E.spatialReferenceId===n.WEB_MERCATOR){const t=i[p.spatialReferenceId][n.WGS84];return null!=t&&(t(e,0,R,0),o(R,0,h,0),h[3]=u(R[1],e[2],e[3],l.radius),!0)}if(p.spatialReferenceId!==n.WGS84&&p.spatialReferenceId!==n.CGCS2000||E.spatialReferenceId!==n.PLATE_CARREE){d.projector(e,0,h,0);const t=p.metersPerUnit??1,r=E.metersPerUnit??1;h[3]=e[3]*t/r}else{const t=i[p.spatialReferenceId][n.SPHERICAL_ECEF],r=i[n.SPHERICAL_ECEF][n.PLATE_CARREE];let o=e[3];null!=t&&null!=r&&(o=u(e[1],e[2],e[3],l.radius)),d.projector(e,0,h,0),h[3]=o}return!0}function u(e,t,r,n){const i=n+t;if(i<n/2||r>i)return Number.MAX_VALUE;const o=Math.abs(p*e)+Math.asin(r/i);return o>=Math.PI/2?Number.MAX_VALUE:r/Math.cos(o)}const R=c(),_=e(),p=h(1);class s{constructor(e,t){this._textures=e,this.loadPromise=null,this._disposed=!1;const r=this._textures.acquire(t);f(r)?(r.then((e=>{this._disposed?d(e):this._textureRef=e})),this.loadPromise=r):this._textureRef=r}dispose(){this._textureRef=d(this._textureRef),this._disposed=!0}get glTexture(){return null!=this._textureRef?this._textureRef.glTexture:null}}export{a,s};
